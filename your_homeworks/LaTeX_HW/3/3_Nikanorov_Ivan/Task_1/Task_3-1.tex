\documentclass[12pt, a4paper]{article}  

\usepackage{etex} % расширение классического tex в частности позволяет подгружать гораздо больше пакетов, чем мы и займёмся далее

%%%%%%%%%% Математика %%%%%%%%%%
\usepackage{amsmath,amsfonts,amssymb,amsthm,mathtools} 
%\mathtoolsset{showonlyrefs=true}  % Показывать номера только у тех формул, на которые есть \eqref{} в тексте.
%\usepackage{leqno} % Нумерация формул слева


%%%%%%%%%%%%%%%%%%%%%%%% Шрифты %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{fontspec}         % пакет для подгрузки шрифтов
\setmainfont{Arial}   % задаёт основной шрифт документа

\defaultfontfeatures{Mapping=tex-text}
\usepackage{indentfirst}  

% why do we need \newfontfamily:
% http://tex.stackexchange.com/questions/91507/
\newfontfamily{\cyrillicfonttt}{Arial}
\newfontfamily{\cyrillicfont}{Arial}
\newfontfamily{\cyrillicfontsf}{Arial}

\usepackage{unicode-math}     % пакет для установки математического шрифта
\setmathfont{Asana Math}      % шрифт для математики
% \setmathfont[math-style=ISO]{Asana Math}
% Можно делать смену начертания с помощью разных стилей

% Конкретный символ из конкретного шрифта
% \setmathfont[range=\int]{Neo Euler}

\usepackage{polyglossia}      % Пакет, который позволяет подгружать русские буквы
\setdefaultlanguage{russian}  % Основной язык документа
\setotherlanguage{english}    % Второстепенный язык документа


%%%%%%%%%% Работа с картинками %%%%%%%%%
\usepackage{graphicx}                  % Для вставки рисунков
\usepackage{graphics}
\graphicspath{{images/}{pictures/}}    % можно указать папки с картинками
\usepackage{wrapfig}                   % Обтекание рисунков и таблиц текстом
\usepackage{rotating}


%%%%%%%%%% Работа с таблицами %%%%%%%%%%
\usepackage{tabularx}            % новые типы колонок
\usepackage{tabulary}            % и ещё новые типы колонок
\usepackage{array}               % Дополнительная работа с таблицами
\usepackage{longtable}           % Длинные таблицы
\usepackage{multirow}            % Слияние строк в таблице
\usepackage{float}               % возможность позиционировать объекты в нужном месте
\usepackage{booktabs}            % таблицы как в книгах!
\renewcommand{\arraystretch}{1.3} % больше расстояние между строками

% Заповеди из документации к booktabs:
% 1. Будь проще! Глазам должно быть комфортно
% 2. Не используйте вертикальные линни
% 3. Не используйте двойные линии. Как правило, достаточно трёх горизонтальных линий
% 4. Единицы измерения - в шапку таблицы
% 5. Не сокращайте .1 вместо 0.1
% 6. Повторяющееся значение повторяйте, а не говорите "то же"
% 7. Есть сомнения? Выравнивай по левому краю!





%%%%%%%%%% Графика и рисование %%%%%%%%%%
\usepackage{tikz, pgfplots}  % язык для рисования графики из latex'a
\usepackage{amscd}                  %Пакеты для рисования
\usepackage[matrix,arrow,curve]{xy} %комунитативных диаграмм
\pgfplotsset{compat=1.14}


%%%%%%%%%% Теоремы %%%%%%%%%%
\theoremstyle{plain}              % Это стиль по умолчанию.  Есть другие стили. 
\newtheorem{theorem}{Теорема}[section]
% Вопросы из зала (от Юрия Николаевича)
\renewcommand{\thetheorem}{\thesection.\Asbuk{theorem}}

\newtheorem{result}{Следствие}[theorem]
% счётчик подчиняется теоремному, нумерация идёт по главам согласованно между собой

\theoremstyle{definition}         % убирает курсив и что-то еще наверное делает ;)
\newtheorem*{defin}{Определение}  % нумерация не идёт вообще

\newtheorem{fignia}{Какая-то фигня}


%%%%%%%%%% Свои команды %%%%%%%%%%
\usepackage{etoolbox}    % логические операторы для своих макросов
\usepackage{xparse}      % больше команд для создания команд

\DeclareMathOperator {\Var}{Var}
\DeclareMathOperator {\Cov}{Cov}
\DeclareMathOperator {\E} {\mathsf{E}}
\def \sig {\ensuremath{\sigma}}
\newcommand{\xs}{\ensuremath {x_1\ldots x_n}}
\newcommand{\apxs} [2]{\ensuremath {x_{#1}\ldots x_{#2}}}%усовершенствование предыдущей команды
\renewcommand {\labelitemi}{\textcolor{blue}{$\bullet$}}
\newcommand{\llim}[1]{\lim\limits_{#1}}

%Картиночки
\newcounter {iapfigure}
\newcommand{\upcaption} [1]{%
 \addtocounter{iapfigure}{1}
  \begin{center}
  Рис. \thesection:\arabic{iapfigure} #1
  \end{center}
}

%Уравнения
\newcounter {iequations}
\newenvironment{strequation}{
 \addtocounter{iequations}{1}
 \equation
 }{
 \tag{Eq. (\arabic{iequations})}
 \endequation
}

%Издевательство над текстом
\usepackage{twoopt}
\newbool{href}
\newbool{vref}
\newcommandtwoopt{\turnandmirror}[3][true][true]{
 \ifstrequal {#1} {true} {\booltrue{href}} {\boolfalse{href}}
 \ifstrequal {#2} {true} {\booltrue{vref}} {\boolfalse{vref}}
 \ifbool{href}
  {\ifbool{vref}
   {\raisebox{\depth}{\scalebox{-1}[-1]{#3}}}
   {\scalebox{-1}[1]{#3}}
  } {\ifbool{vref}
   {\raisebox{\depth}{\scalebox{1}[-1]{#3}}}
   {\raisebox{\depth}{\scalebox{1}[1]{#3}}}
  }
}
%\turnandmirror [переворачивать ли зеркально (только true или false)] [переворачивать ли вверх ногами (только true или false)] {текст}

% Пакет, который ставит в каждом первом абзаце главы красную строку
% Просто, чтобы эта pdf-ка нормально смотрелась :)
\usepackage{indentfirst}  
\setkeys{russian}{babelshorthands=true}
% обо всех волшебных строках на следующем семинаре! 


\author{Никаноров Иван}
\title{Домашняя №3. Свои собственные}
\date{\today}

\begin{document}

\maketitle

\newpage
\section{Формулы}
 \begin{itemize}
 \item $\Var(x)  \qquad Var(x)$
 \item $\Cov(x,y)=\E[(x-\E(x))(y-\E(y))]$
 \item 
 \sig-алгебра
 \item \xs
 \item 
  \begin{itemize}
  \item \apxs{a}{z}
  \item \apxs{1}{6}
  \item \apxs{(a,b)}{(c,d)}
  \end{itemize}
 \item
  \begin{itemize}
  \item Пределы должны быть такими $\llim{n \to \infty}  \frac{n+1}{n}$
  \item Вне текстовая формула $$\llim{n \to \infty}  \frac{n+1}{n}$$
%    \renewcommand{\lim}[1]{\lim\limits_{#1}}
%  \item $\lim{x \to 5} \frac{x}{x^2+1}$
  \end{itemize}
 \end{itemize}
 
\section{Рисуночки}
 \begin{figure} [H]
 \includegraphics[scale=0.3]{IMG_0153.jpg}
 \upcaption {Здание МГУ}
 \end{figure}

\section{Уравнения}

\begin{strequation}
 5+\sig
\end{strequation}

\begin{strequation}
 \Var(x)=15
\end{strequation}

\section{Издевательство над текстом}

\begin{itemize}
\item какой-то текст \turnandmirror[false][false]{мама} ещё какой-то текст
\item какой-то текст \turnandmirror[true][false]{мама} ещё какой-то текст
\item какой-то текст \turnandmirror[false][true]{мама} ещё какой-то текст
\item какой-то текст \turnandmirror{мама} ещё какой-то текст
\end{itemize}

\end{document}