\documentclass[12pt, a4paper]{article}  

%%%%%%%%%% Математика %%%%%%%%%%
\usepackage{amsmath,amsfonts,amssymb,amsthm,mathtools} 
%\mathtoolsset{showonlyrefs=true}  % Показывать номера только у тех формул, на которые есть \eqref{} в тексте.
%\usepackage{leqno} % Нумерация формул слева


%%%%%%%%%%%%%%%%%%%%%%%% Шрифты %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{fontspec}         % пакет для подгрузки шрифтов
\setmainfont{Linux Libertine O}   % задаёт основной шрифт документа

% why do we need \newfontfamily:
% http://tex.stackexchange.com/questions/91507/
\newfontfamily{\cyrillicfonttt}{Linux Libertine O}
\newfontfamily{\cyrillicfont}{Linux Libertine O}
\newfontfamily{\cyrillicfontsf}{Linux Libertine O}

\usepackage{unicode-math}     % пакет для установки математического шрифта
\setmathfont{Asana Math}      % шрифт для математики
% \setmathfont[math-style=ISO]{Asana Math}
% Можно делать смену начертания с помощью разных стилей

% Конкретный символ из конкретного шрифта
% \setmathfont[range=\int]{Neo Euler}

\usepackage{polyglossia}      % Пакет, который позволяет подгружать русские буквы
\setdefaultlanguage{russian}  % Основной язык документа
\setotherlanguage{english}    % Второстепенный язык документа


%%%%%%%%%% Работа с картинками %%%%%%%%%
\usepackage{graphicx}                  % Для вставки рисунков
\usepackage{graphics} 
\graphicspath{{images/}{pictures/}}    % можно указать папки с картинками
\usepackage{wrapfig}                   % Обтекание рисунков и таблиц текстом
\usepackage{subfigure}                 % для создания нескольких рисунков внутри одного


%%%%%%%%%% Работа с таблицами %%%%%%%%%%
\usepackage{tabularx}            % новые типы колонок
\usepackage{tabulary}            % и ещё новые типы колонок
\usepackage{array}               % Дополнительная работа с таблицами
\usepackage{longtable}           % Длинные таблицы
\usepackage{multirow}            % Слияние строк в таблице
\usepackage{float}               % возможность позиционировать объекты в нужном месте 
\usepackage{booktabs}            % таблицы как в книгах!  
\renewcommand{\arraystretch}{1.3} % больше расстояние между строками


%%%%%%%%%% Графика и рисование %%%%%%%%%%
\usepackage{tikz, pgfplots}  % язык для рисования графики из latex'a
\usepackage{amscd}                  %Пакеты для рисования 
\usepackage[matrix,arrow,curve]{xy} %комунитативных диаграмм


%%%%%%%%%% Теоремы %%%%%%%%%%
\theoremstyle{plain}              % Это стиль по умолчанию.  Есть другие стили. 
\newtheorem{theorem}{Теорема}[section]
\newtheorem{result}{Следствие}[theorem]
% счётчик подчиняется теоремному, нумерация идёт по главам согласованно между собой

\theoremstyle{definition}         % убирает курсив и что-то еще наверное делает ;)
\newtheorem*{defin}{Определение}  % нумерация не идёт вообще

\newtheorem{fignia}{Какая-то фигня}


%%%%%%%%%% Свои команды %%%%%%%%%%
\usepackage{etoolbox}    % логические операторы для своих макросов


% Все свои команды лучше всего определять не по ходу текста, как это сделано в этом документе, а в преамбуле!


\title{Свои команды и макросы}
\date{\today}

\begin{document}

\maketitle

\section{Теоремы}

\begin{defin}
\textbf{ Биноминальным коэффициентом} называется выражение $C_n^k = \frac{n!}{k!(n-k)!}$
\end{defin}

\begin{theorem}[Комбинаторное тождество]\label{th:1}
 \[C_n^0 + C_n^1 + C_n^2 + C_n^3 + \ldots + C_n^n = 2^n \]
\end{theorem}
\begin{proof}
Из Бинома Ньютона очевидно, что 

\[ 2^n = (1 + 1)^n = \sum_{k=0}^n C_n^k \cdot 1^k \cdot 1^{n-k} = \sum_{k=0}^n C_n^k. \] 
\end{proof}

\begin{result} \label{sl:1.1} 
Мощность множества всех подмножеств непустого множества равна $2^n$! 
\end{result}

Следствие \ref{sl:1.1} следует из теоремы \ref{th:1} со страницы \pageref{th:1}.


\begin{fignia}
	 Петя любит Катю, а Катя любит программировать и ботать по ночам! 
\end{fignia}


\section{Новые команды - 1}
\subsection{Создание простых команд}
% Уже делали вот такие команды! 
% \DeclareMathOperator{\Var}{Var} можно только в прембуле!

\def \a{\alpha}
\def\R{\ensuremath{\mathbb{R}} } 

% \newcomand{имя команды}{Что делать} 

\newcommand{\RR}{\ensuremath{\mathbb{R}} }

Неважно как написать \R или \RR. По факту это будет одно и то же.

% Спросить про пробел!


\subsection{Команды с аргументами}
% \newcomand{имя команды}[количество аргументов]{Что делать}

\newcommand{\bb}[1]{\ensuremath{\mathbb{#1}} }

\bb{R} или \bb{Z} или \bb{Q}


$4/7$ или $^4/_7$

\newcommand{\fr}[2]{^#1/_#2}

$\fr{4}{7}$

% Собственноручная расстановка пробелов
\newcommand{\iid}{\text{i.\hspace{1pt}i.\hspace{1pt}d.}}

$iid$ или $\iid$

\subsection{Переопределение команд}

$ 1 \le 2 $ и $ 2 \ge 1 $

\renewcommand{\le}{\leqslant}
\renewcommand{\ge}{\geqslant}

$ 1 \le 2 $ и $ 2 \ge 1 $

\section{Счётчики}

% Можно объявить счётчик вот так:
% \newcounter{имя счётчика}[то чему подчиняется счётчик (не обязательно)]

\newcounter{jtem}[section]

% Счётчик можно установить на любую величину:
\setcounter{jtem}{13}

% Cчётчик можно вывести в любой из форм!
\arabic{jtem}
\alph{jtem}
\Alph{jtem}
\asbuk{jtem}
\Asbuk{jtem}
\roman{jtem}
\Roman{jtem}

% Можно выяснить какой номер у текущей главы или страницы
\arabic{section}
\arabic{page}
\Roman{page}

% Можно поменять тип счётчика в нумерации!
\renewcommand{\thepage}{\Roman{page}}
\renewcommand{\thesection}{\Asbuk{section}}
\setcounter{section}{0}
% Обратите внимание на то, что для глав счётчик сброшен, а для страниц нет!

% Дефолтные счётчики в LaTeX:  part, chapter, section, subsection, subsubsection, paragraph, subparagraph, page, figure, table, footnote, mpfootnote, equation
% Также определены счётчики для списков: enumi, enumii, enumiii, enumiv! 



\section{Новые команды - 2}
\subsection{Списки}


\begin{enumerate}
	\renewcommand{\labelenumi}{\Roman{enumi}}
	\renewcommand{\labelenumii}{\asbuk{enumii}}
\item Первый пункт
\item Второй пункт
\item Третий пункт
\begin{enumerate}
\item Первый подпункт
\item Второй подпункт
\end{enumerate}
\end{enumerate}


\begin{enumerate}
  \renewcommand{\labelenumi}{\arabic{enumi}}
  \renewcommand{\labelenumii}{\arabic{enumi}.\arabic{enumii}}
\item Первый элемент
  \begin{enumerate}
  \item Первый вложенный элемент
  \item Второй вложенный элемент
  \end{enumerate}
\end{enumerate}



\subsection{Задача}

\newcounter{i}
\newcommand{\ex}[1]{%
\addtocounter{i}{1}
\textcolor{blue}{Задача \arabic{i}}

#1\\}

Напишем парочку задач для задачника!

\ex{В корзине лежат 12 яблок и 10 апельсинов. Ваня выбирает из неё яблоко или апельсин, после чего Надя берёт и яблоко, и апельсин. В каком случае Надя имеет большую свободу выбора: если Ваня взял яблоко или если он взял апельсин?}

\ex{Шестеро друзей пришли в театр! В ложе 6 мест. Среди друзей две девушки, которые не могут сидеть скраю. Сколько способов рассадки существует?}



\section{etoolbox}
% Одно из применений - уничтожение какого-то куска текста!
\newbool{answers}
\booltrue{answers}
%\boolfalse{answers}
\renewcommand{\ex}[2][Нет ответа.]{%

\addtocounter{jtem}{1}
Задача \thesection.\arabic{jtem}. #2%

\ifbool{answers}{Ответ. #1}{}
}

\ex[хз]{В корзине лежат 12 яблок и 10 апельсинов. Ваня выбирает из неё яблоко или апельсин, после чего Надя берёт и яблоко, и апельсин. В каком случае Надя имеет большую свободу выбора: если Ваня взял яблоко или если он взял апельсин?}

\ex[много]{Шестеро друзей пришли в театр! В ложе 6 мест. Среди друзей две девушки, которые не могут сидеть скраю. Сколько способов рассадки существует?}

\end{document}

